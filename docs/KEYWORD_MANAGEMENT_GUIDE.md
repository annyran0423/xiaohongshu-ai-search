# 关键词管理指南

## 🎯 概述

本项目使用统一的关键词管理系统来管理搜索关键词扩展和主题冲突检测，避免了以往需要手动维护多个地方的繁琐问题。

## 📁 文件结构

```
search-frontend/src/lib/config/keywords.ts  # 统一关键词配置文件
scripts/manage-keywords.js                  # 关键词管理工具
```

## 🔧 关键词管理工具使用

### 查看当前配置

```bash
# 查看所有关键词配置
node scripts/manage-keywords.js show
```

### 添加关键词扩展

```bash
# 为"酒店"关键词添加扩展词
node scripts/manage-keywords.js add-expansion 酒店 住宿,宾馆,旅店,预订,入住

# 为"餐厅"关键词添加扩展词
node scripts/manage-keywords.js add-expansion 餐厅 吃饭,美食,菜品,预订,环境
```

### 添加主题关键词

```bash
# 为"酒店"主题添加关键词
node scripts/manage-keywords.js add-theme 酒店 住宿,宾馆,预订,入住,服务

# 为"餐厅"主题添加关键词
node scripts/manage-keywords.js add-theme 餐厅 吃饭,菜品,服务,环境,价格
```

### 移除关键词扩展

```bash
# 移除"酒店"关键词扩展
node scripts/manage-keywords.js remove-expansion 酒店
```

### 移除主题关键词

```bash
# 移除"酒店"主题关键词
node scripts/manage-keywords.js remove-theme 酒店
```

## 📊 配置说明

### 关键词扩展配置

关键词扩展用于扩展用户搜索关键词，提高搜索覆盖率：

```typescript
export const KEYWORD_EXPANSIONS: Record<string, string[]> = {
  // 摄影相关
  拍照: ['摄影', '机位', '拍摄', '照相', '角度', '景点', '美景', '风景'],
  摄影: ['拍照', '机位', '拍摄', '镜头', '角度', '照片', '相片'],

  // 美食相关
  美食: ['餐厅', '吃', '美食', '探店', '必吃', '推荐', '美食攻略'],

  // 购物相关
  买手店: [
    '精品店',
    '购物',
    '时尚',
    '品牌',
    '选品',
    '设计师',
    '独立设计师',
    '时尚买手',
    '概念店',
    '潮流',
  ],
  购物: ['买手店', '精品店', '商场', '品牌店', '消费', '采购', '选购'],
};
```

### 主题关键词配置

主题关键词用于检测内容主题冲突，确保搜索结果的相关性：

```typescript
export const THEME_KEYWORDS: Record<string, string[]> = {
  // 购物主题
  买手店: [
    '精品店',
    '购物',
    '时尚',
    '品牌',
    '选品',
    '设计师',
    '时装',
    '穿搭',
    '潮流',
  ],
  购物: ['商场', '品牌店', '消费', '采购', '选购', '折扣', '促销'],

  // 美食主题
  美食: ['餐厅', '吃饭', '菜品', '口味', '厨师', '菜单', '食材'],

  // 咖啡主题
  咖啡: ['咖啡馆', '咖啡店', '咖啡厅', '拉花', '手冲', '豆子', '烘焙'],
};
```

## 🔍 工作原理

### 1. 关键词扩展机制

当用户搜索"买手店"时，系统会自动扩展为：

```
原关键词: 买手店
扩展关键词: 买手店, 精品店, 购物, 时尚, 品牌, 选品, 设计师, 独立设计师, 时尚买手, 概念店, 潮流
```

### 2. 主题冲突检测

当搜索"买手店"时，如果内容包含"餐厅"、"菜品"等美食相关关键词，会被识别为主题冲突：

```typescript
// 检测到冲突的逻辑
if (queryTheme === '买手店' && content.contains(['餐厅', '菜品'])) {
  score *= 0.2; // 严重降低评分
}
```

### 3. 自动同步

所有关键词配置都会自动同步到以下文件中：

- `search-frontend/src/lib/services/search.ts` - 搜索服务
- `search-frontend/src/lib/services/dashscope.ts` - AI 服务

## 💡 使用建议

### 添加新关键词

1. **先分析用户搜索习惯**：观察用户常用的搜索词
2. **确定扩展词**：选择相关度高的同义词和关联词
3. **添加关键词扩展**：使用管理工具添加配置
4. **测试效果**：验证搜索结果的准确性

### 添加新主题

1. **识别主题冲突**：发现不同主题的内容混杂问题
2. **定义主题关键词**：列出该主题的核心关键词
3. **添加主题配置**：使用管理工具添加配置
4. **验证效果**：检查是否正确过滤了不相关内容

## 🚀 优势

### ✅ 维护便利

- **一处配置**：只需在一个文件中维护关键词
- **自动同步**：所有使用地方自动获取最新配置
- **命令行工具**：提供便捷的管理命令

### ✅ 功能强大

- **关键词扩展**：提高搜索覆盖率和准确性
- **主题冲突检测**：确保搜索结果的相关性
- **动态管理**：支持运行时添加和移除关键词

### ✅ 使用简单

- **统一接口**：所有服务使用相同的关键词管理器
- **类型安全**：TypeScript 类型检查确保配置正确
- **错误处理**：完善的错误处理和日志记录

## 📝 最佳实践

1. **定期更新**：根据用户反馈定期更新关键词配置
2. **数据驱动**：基于搜索日志分析来调整关键词扩展
3. **测试验证**：每次修改后都要测试搜索效果
4. **文档同步**：及时更新相关的使用文档

## 🔧 故障排除

### 关键词没有生效

1. 检查关键词配置文件是否正确更新
2. 重启应用服务以确保新配置生效
3. 检查控制台日志是否有相关错误信息

### 主题冲突检测不准确

1. 确认主题关键词配置是否完整
2. 检查关键词是否有重复或冲突
3. 调整相关性评估算法的权重参数

### 管理工具无法使用

1. 确保 Node.js 环境正常
2. 检查脚本文件权限
3. 验证关键词配置文件路径是否正确

---

## 📞 技术支持

如果在使用过程中遇到问题，请：

1. 查看控制台错误日志
2. 检查关键词配置文件格式
3. 联系开发团队获取帮助
